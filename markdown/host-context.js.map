{"version":3,"file":"host-context.js","sourceRoot":"","sources":["../../src/markdown/host-context.ts"],"names":[],"mappings":"AAAA,4BAA4B;AAC5B,EAAE;AACF,kEAAkE;AAClE,mEAAmE;AACnE,0CAA0C;AAC1C,EAAE;AACF,kDAAkD;AAClD,EAAE;AACF,sEAAsE;AACtE,oEAAoE;AACpE,2EAA2E;AAC3E,sEAAsE;AACtE,iCAAiC;AAEjC,OAAO,EAAC,aAAa,EAAC,MAAM,6BAA6B,CAAC;AAI1D,MAAM,OAAO,WAAW;IAAxB;QAIW,cAAS,GAAG,IAAI,GAAG,EAAiB,CAAC;IAwChD,CAAC;IApCC,IAAI,YAAY;QACd,OAAO,CAAC,CAAC,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC;IAC/B,CAAC;IAED,cAAc;QACZ,IAAI,CAAC,IAAI,CAAC,SAAS,CAAC,IAAI;YAAE,OAAO;QACjC,MAAM,CAAC,GAAG,SAAS,CAAC,GAAG,IAAI,CAAC,SAAS,CAAC,MAAM,EAAE,CAAC;QAC/C,IAAI,CAAC,SAAS,CAAC,KAAK,EAAE,CAAC;QACvB,IAAI,CAAC,eAAe,GAAG,SAAS,CAAC;QACjC,IAAI,CAAC,cAAc,GAAG,SAAS,CAAC;QAChC,KAAK,MAAM,IAAI,IAAI,SAAS,EAAE;YAC5B,IAAI,CAAC,SAAS,CAAC,OAAO,CAAC,MAAM,EAAE,CAAC;SACjC;IACH,CAAC;IAED,YAAY,CAAC,MAAqB,EAAE,KAAoB;QACtD,IAAI,CAAC,eAAe,GAAG,MAAM,CAAC;QAC9B,IAAI,CAAC,cAAc,GAAG,KAAK,CAAC;QAC5B,IAAI,CAAC,SAAS,CAAC,GAAG,CAAC,MAAM,CAAC,CAAC;QAC3B,IAAI,CAAC,SAAS,CAAC,GAAG,CAAC,KAAK,CAAC,CAAC;QAC1B,MAAM,CAAC,SAAS,CAAC,OAAO,CAAC,MAAM,EAAE,CAAC;QAClC,KAAK,CAAC,SAAS,CAAC,OAAO,CAAC,MAAM,EAAE,CAAC;IACnC,CAAC;IAED,eAAe,CAAC,IAAmB,EAAE,EAAiB;QACpD,IAAI,IAAI,CAAC,SAAS,CAAC,GAAG,CAAC,EAAE,CAAC,EAAE;YAC1B,IAAI,CAAC,SAAS,CAAC,MAAM,CAAC,IAAI,CAAC,CAAC;YAC5B,IAAI,IAAI,CAAC,eAAe,KAAK,IAAI,EAAE;gBACjC,IAAI,CAAC,eAAe,GAAG,EAAE,CAAC;aAC3B;YACD,IAAI,CAAC,SAAS,CAAC,OAAO,CAAC,MAAM,EAAE,CAAC;SACjC;QACD,IAAI,CAAC,SAAS,CAAC,GAAG,CAAC,EAAE,CAAC,CAAC;QACvB,IAAI,CAAC,cAAc,GAAG,EAAE,CAAC;QACzB,EAAE,CAAC,SAAS,CAAC,OAAO,CAAC,MAAM,EAAE,CAAC;IAChC,CAAC;CACF;AACD,MAAM,CAAC,MAAM,WAAW,GAAG,aAAa,CACtC,aAAa,CACd,CAAC;AAEF,MAAM,UAAU,SAAS,CACvB,OAAoB,EACpB,IAAmB,EACnB,MAAe;IAEf,OAAO,CAAC,SAAS,GAAG,IAAI,CAAC;IACzB,OAAO,CAAC,WAAW,GAAG,MAAM,CAAC;IAC7B,IAAI,CAAC,SAAS,CAAC,OAAO,CAAC,MAAM,EAAE,CAAC;AAClC,CAAC","sourcesContent":["// Copyright 2022 Google LLC\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {createContext} from '../deps/lit-labs-context.js';\n\nimport {ViewModelNode} from './view-model.js';\n\nexport class HostContext {\n  focusNode?: ViewModelNode;\n  focusOffset?: number;\n  root?: ViewModelNode;\n  readonly selection = new Set<ViewModelNode>();\n  selectionAnchor?: ViewModelNode;\n  selectionFocus?: ViewModelNode;\n\n  get hasSelection() {\n    return !!this.selection.size;\n  }\n\n  clearSelection() {\n    if (!this.selection.size) return;\n    const [...selection] = this.selection.values();\n    this.selection.clear();\n    this.selectionAnchor = undefined;\n    this.selectionFocus = undefined;\n    for (const node of selection) {\n      node.viewModel.observe.notify();\n    }\n  }\n\n  setSelection(anchor: ViewModelNode, focus: ViewModelNode) {\n    this.selectionAnchor = anchor;\n    this.selectionFocus = focus;\n    this.selection.add(anchor);\n    this.selection.add(focus);\n    anchor.viewModel.observe.notify();\n    focus.viewModel.observe.notify();\n  }\n\n  extendSelection(from: ViewModelNode, to: ViewModelNode) {\n    if (this.selection.has(to)) {\n      this.selection.delete(from);\n      if (this.selectionAnchor === from) {\n        this.selectionAnchor = to;\n      }\n      from.viewModel.observe.notify();\n    }\n    this.selection.add(to);\n    this.selectionFocus = to;\n    to.viewModel.observe.notify();\n  }\n}\nexport const hostContext = createContext<HostContext | undefined>(\n  'hostContext'\n);\n\nexport function focusNode(\n  context: HostContext,\n  node: ViewModelNode,\n  offset?: number\n) {\n  context.focusNode = node;\n  context.focusOffset = offset;\n  node.viewModel.observe.notify();\n}\n"]}